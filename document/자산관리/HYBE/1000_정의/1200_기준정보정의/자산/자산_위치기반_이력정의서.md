# 문서명: 위치기반_이력정의서.md
- 작성일: 2025-05-23
- 작성자: 송영근
- 내  용: 자산관리 시스템에서 RFID, GPS, BLE 등 위치기반 기술을 활용하여 자산의 실시간 위치 이동을 기록하고, 위치 이력을 자동 생성하는 구조 정의서

---

## [1. 정의]

**위치기반 이력(Position Tracking Log)**은 자산의 이동을  
RFID 스캔, GPS 위치좌표, BLE 비콘 등 **위치인식 기술을 통해 자동 감지하여**,  
자산의 위치 변경 로그를 실시간 또는 주기적으로 기록하는 자동 로그 구조이다.

---

## [2. 적용 기술 및 방식]

| 기술 | 방식 | 설명 |
|------|------|------|
| RFID | 리더기 게이트 통과 | 고정 위치를 기준으로 이동 인식 |
| GPS | 위도/경도 좌표 수집 | 실외 자산 위치 이동 감지 |
| BLE | 블루투스 근접 신호 | 실내 자산 근거리 위치 인식 |

---

## [3. 기록 조건]

- 위치 변화가 일정 거리(예: 5m 이상) 발생한 경우
- 위치값이 변동되고, 이전 기록과 1분 이상 차이날 경우
- 지정 구역 이탈 또는 진입 시 자동 로그 생성

---

## [4. 연동 테이블 구조]

```txt
ZFI_ASSET_POSITION_LOG
 ├─ assetId        → ZFI_ASSET_MASTER.id
 ├─ method         = RFID, GPS, BLE
 ├─ position       = SEOUL_HQ_GATE_1 / BLE_BEACON_03 / GPS(37.50,127.02)
 ├─ status         = ENTERED / EXITED / STAY
 ├─ rssi / accuracy (BLE/GPS용)
 ├─ loggedAt       = 기록 시각
````

---

## \[5. 필드 예시]

| 필드명            | 설명                            |
| -------------- | ----------------------------- |
| assetId        | 자산 ID                         |
| method         | 위치 감지 방식 (RFID, GPS, BLE)     |
| position       | 위치 식별자 (코드 or GPS 좌표)         |
| status         | 이동 상태 (ENTERED, EXITED, STAY) |
| signalStrength | BLE/RFID 수신 강도 (선택)           |
| loggedAt       | 위치 감지 시각                      |

---

## \[6. 활용 목적]

* 무대/창고/사무실/배송 등 자산 위치 추적
* 이동이력 자동 기록 (ZFI\_ASSET\_LOG 연계)
* 지정 위치 이탈 시 경고 트리거
* RFID 스캔 시 `ZFI_ASSET_MOVEMENT` 자동 생성 유도 가능

---

## \[7. 관리 기준]

* GPS 좌표는 `position` 필드에 문자열로 저장 또는 좌표 필드 추가 가능
* BLE 구역은 `BLE_BEACON_ID` 또는 `ROOM_ID` 등으로 명명 통일
* `status`는 이동 방향 기록 또는 현재 위치 판단 기준

---

## \[8. 확장 고려 사항]

* 지오펜스(GeoFence) 기반 자동 반입/반출 트리거
* 위치 기반 자동 자산 상태 변경 (예: 출고 구역 이탈 → RENTED 상태)
* 관리자 대시보드에 실시간 위치 표시 UI 연계
* RFID 게이트 통과 로그 ↔ 수작업 이동 등록 비교 시스템

---

