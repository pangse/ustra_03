좋아, 자산관리 프로젝트 이어서 진행할게.
지금은 `자산 리폼` 정의서까지 완료된 상태고, 그 다음 순서로 \*\*`ZFI_ASSET_REFORM_테이블정의서.md`\*\*를 작성해야 해.

---

## ✅ 현재 이어서 진행할 항목

> **ZFI\_ASSET\_REFORM\_테이블정의서.md**
> 기존 자산 → 리폼 자산 전환 이력, 신규 자산 연결, 비용 및 사유 기록 등 포함

곧바로 생성해서 보여줄게.


````md
# 문서명: ZFI_ASSET_REFORM_테이블정의서.md
- 작성일: 2025-05-23
- 작성자: 송영근
- 내  용: 자산 리폼 처리 시 기존 자산과 새로 등록된 자산 간의 연계 정보를 관리하고, 리폼 사유, 비용, 작업자 등의 정보를 포함하는 자산 리폼 이력 테이블 정의서

---

## [1. 테이블명 및 목적]

- 테이블명: `ZFI_ASSET_REFORM`
- 목적: 리폼 처리된 자산에 대해 기존 자산과 신규 자산 간의 연계, 사유, 비용 등을 기록하고,  
  자산의 재등록 및 이력 추적을 가능하게 하여 회계/운영/통제 목적의 정보를 보존함

---

## [2. 테이블 구조 (Prisma 기준)]

```prisma
model ZFI_ASSET_REFORM {
  id              String   @id @default(uuid())     // 리폼 이력 ID
  sourceAssetId   String                              // 기존 자산 ID (ZFI_ASSET_MASTER.id)
  newAssetId      String                              // 리폼 후 신규 자산 ID (ZFI_ASSET_MASTER.id)
  orgId           String                              // 리폼 처리 조직 ID (ZCM_ORG_UNIT.orgId)
  reformDate      String                              // 리폼 완료일
  reformReason    String                              // 리폼 사유 코드 (공통코드: REFORM_REASON)
  reformDetails   String?                             // 리폼 상세 설명
  cost            Float?                              // 리폼 비용
  vendorId        String?                             // 외부 처리 업체 ID (ZFI_VENDOR.vendorId)
  createdBy       String                              // 등록자 ID (ZCM_USER.userId)
  createdAt       String
  updatedBy       String?
  updatedAt       String?
}
````

---

## \[3. 연관 테이블 관계]

| 필드                        | 참조 테이블             | 설명                |
| ------------------------- | ------------------ | ----------------- |
| sourceAssetId, newAssetId | `ZFI_ASSET_MASTER` | 기존 자산 → 신규 자산 연결  |
| orgId                     | `ZCM_ORG_UNIT`     | 리폼 처리 조직          |
| vendorId                  | `ZFI_VENDOR`       | 외부 처리 업체          |
| reformReason              | `ZCM_CODE_VALUE`   | 리폼 사유 (REASON 코드) |
| createdBy                 | `ZCM_USER`         | 리폼 등록자            |

---

## \[4. 처리 로직 및 트리거]

| 조건       | 처리 내용                                        |
| -------- | -------------------------------------------- |
| 리폼 등록 시  | 기존 자산 상태 → `REFORMED`, 신규 자산 상태 → `ACTIVE`   |
| 비용 입력 시  | SAP 연동 또는 자산가치 조정 대상 가능성 있음                  |
| 신규 자산 생성 | 반드시 `ZFI_ASSET_MASTER` 등록 → `newAssetId`로 연결 |
| 이력 기록    | 변경 불가, 모든 리폼은 누적 저장됨                         |

---

## \[5. 관리 기준]

* 리폼 처리는 결재 또는 관리자 승인 후 수행
* 신규 자산은 고유 ID 및 RFID 태그로 완전 별개 자산으로 등록됨
* `reformReason`은 공통코드 `REFORM_REASON`에 등록된 사유만 사용
* 리폼 처리자는 `createdBy`, 외부 업체는 `vendorId`로 명확히 분리 기록

---

## \[6. 확장 고려 사항]

* 첨부파일(`ZFI_ASSET_REFORM_FILE`) 설계 가능 (디자인 도면, 작업 결과물 등)
* SAP 자산 마스터 전환 연계 가능 (`SAP_ASSET_NO`)
* 리폼 유형별 자동 분개 처리 (복수 자산 병합, 분할 등)

---

```
```
