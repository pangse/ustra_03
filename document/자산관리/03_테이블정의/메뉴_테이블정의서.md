````md
# 문서명: ZCM_MENU_테이블정의서.md (확장 버전)
- 작성일: 2025-05-23
- 작성자: 송영근
- 내  용: 자산관리 시스템에서 기능 및 화면 단위의 메뉴 정보를 계층 구조로 관리하고, 역할 기반 접근 제어 및 메뉴 유형, 기능 권한 플래그, 접근 로깅 확장을 포함한 전체 메뉴 설계서

---

## [1. 테이블명 및 목적]

- 테이블명: `ZCM_MENU`
- 목적: 시스템의 모든 기능/화면/버튼을 메뉴 단위로 정의하고 계층 구조로 관리하며,  
  역할과 연결된 접근 권한, 기능 플래그, 메뉴 유형 등을 포함해 확장 가능한 메뉴 시스템을 구성함

---

## [2. 테이블 구조 (Prisma 기준)]

```prisma
model ZCM_MENU {
  id             String   @id @default(uuid())     // 메뉴 식별자
  menuCode       String                             // 메뉴 코드 (예: ASSET001)
  menuName       String                             // 메뉴명
  path           String                             // 라우팅 경로 (예: /asset/register)
  parentMenuId   String?                            // 상위 메뉴 ID (ZCM_MENU.id)
  menuLevel      Int                                // 계층 레벨 (1,2,3)
  menuType       String                             // 메뉴 유형 (SCREEN, FUNCTION, BUTTON 등)
  displayOrder   Int                                // 정렬 순서
  isActive       Boolean  @default(true)            // 메뉴 활성화 여부

  allowRead      Boolean  @default(true)            // 읽기 허용
  allowWrite     Boolean  @default(false)           // 작성 허용
  allowApprove   Boolean  @default(false)           // 승인 허용
  allowDelete    Boolean  @default(false)           // 삭제 허용

  createdBy      String
  createdAt      String
  updatedBy      String?
  updatedAt      String?
}
````

---

## \[3. 연관 테이블 관계]

| 필드           | 참조 테이블                     | 설명                |
| ------------ | -------------------------- | ----------------- |
| parentMenuId | `ZCM_MENU.id`              | 계층형 상위 메뉴 지정      |
| id           | `ZCM_ROLE_MENU_MAP.menuId` | 역할별 메뉴 권한 연결      |
| menuCode     | `ZCM_MENU_LOG.menuCode`    | 접근 이력 기록 대상 메뉴 코드 |

---

## \[4. 관리 기준]

* `menuType`은 다음과 같이 구분됨:

  * `SCREEN`: 전체 페이지
  * `FUNCTION`: 백엔드 또는 기능 단위
  * `BUTTON`: 화면 내 버튼 단위 기능
* 플래그(`allowRead`, `allowWrite`, 등)는 역할-메뉴 맵핑 시 접근 수준 제어에 활용
* 메뉴 삭제는 불가하며 `isActive = false`로 숨김 처리

---

## \[5. 예시 데이터]

| menuCode            | menuName | menuType | path            | level | allowWrite |
| ------------------- | -------- | -------- | --------------- | ----- | ---------- |
| ASSET               | 자산관리     | SCREEN   | /asset          | 1     | false      |
| ASSET001            | 자산등록     | SCREEN   | /asset/register | 2     | true       |
| ASSET001\_BTN\_SAVE | 저장버튼     | BUTTON   | null            | 3     | true       |

---

## \[6. 확장 고려 사항]

* 기능 권한 단위 분리(READ/WRITE/DELETE/APPROVE)
* `visibleToRoles` 필드로 특정 역할만 노출되게 설정 가능
* 사용자별 접근 로그 기록용 `ZCM_MENU_LOG` 테이블 구성 가능

---

## \[7. 보안 및 감사 연동]

* 접근 시도/성공/실패 로그는 `ZCM_MENU_LOG`에 자동 기록
* 보안 민감 메뉴(`menuType = FUNCTION`, `approve = true`)는 별도 감사 대상
* 권한 없는 접근 시도는 차단되며 로그로 남겨야 함

---

```
```
