````md
# 문서명: 결재_정의서.md
- 작성일: 2025-05-23
- 작성자: 송영근
- 내  용: 자산관리 시스템에서 자산의 대여, 수선, 리폼, 폐기 등의 요청에 대해 승인 절차를 구성하고, 역할 기반 결재선, 승인 흐름, 자동 상태 변경 등을 정의한 문서

---

## [1. 정의]

결재(Approval)는 자산과 관련된 중요한 행위 요청(예: 대여, 수선, 리폼, 폐기 등)에 대해  
지정된 승인자 또는 조직장, 관리자 등 **결재권한 보유자가 승인 또는 반려하는 절차**를 의미하며,  
결재 상태에 따라 자산의 상태가 자동으로 변경된다.

---

## [2. 결재가 필요한 주요 요청]

| 요청 유형 | 설명 |
|-----------|------|
| 자산 대여 | 고가 자산 또는 외부 반출 시 승인 필수 |
| 자산 수선 | 수선 비용이 일정 금액 이상일 경우 |
| 자산 리폼 | 신규 자산으로 전환 시 승인 필요 |
| 자산 폐기 | 영구 폐기 시 관리자 승인 필수 |
| 자산 이동 | 보안구역 간 이동 시 승인 필요 (선택 사항)

---

## [3. 결재선 구성 방식]

### ▶ 구성 기준

| 단계 | 결재자 |
|------|--------|
| 1단계 | 조직장 (`orgManagerId`) |
| 2단계 | 승인 권한자 (`ROLE_APPROVER`) |
| 3단계 (선택) | 운영자, 재무팀장, 회계관리자 등 |

- 결재선은 `ZFI_APPROVAL_LINE`, `ZFI_APPROVAL_LINE_STEP` 테이블로 구성됨
- 결재는 **병렬 또는 순차 처리** 방식 설정 가능

---

## [4. 결재 상태 흐름]

```txt
[요청 등록]
 → [승인 대기]
   → [승인 완료] → 자산 상태 자동 변경
   → [반려] → 요청 상태 REJECTED 처리
````

### 예: 대여 요청 흐름

```
REQUESTED → PENDING → APPROVED → RENTED
                      ↘ REJECTED
```

---

## \[5. 역할 및 권한 연계]

| 역할             | 권한           |
| -------------- | ------------ |
| ROLE\_USER     | 요청 가능        |
| ROLE\_APPROVER | 승인 가능        |
| ROLE\_ADMIN    | 요청 및 승인 가능   |
| 조직장            | 자동 결재자 지정 대상 |

---

## \[6. 결재 정보 구성 항목]

| 항목     | 설명                                 |
| ------ | ---------------------------------- |
| 요청 ID  | 자산 대여/수선/리폼/폐기와 연계된 요청 번호          |
| 요청자    | 자산 요청을 등록한 사용자                     |
| 요청 일시  | 요청 등록 시각                           |
| 결재 단계  | 1단계, 2단계, 병렬 처리 여부                 |
| 결재자 ID | 결재 담당자                             |
| 결재 의견  | 승인/반려 사유                           |
| 첨부파일   | 관련 문서 업로드 가능 (`ZFI_APPROVAL_FILE`) |
| 상태     | PENDING / APPROVED / REJECTED      |

---

## \[7. 연계 테이블 및 구조]

```txt
ZFI_APPROVAL_LINE
 └─ ZFI_APPROVAL_LINE_STEP
      └─ 결재자 정보, 상태, 의견, 순서
      ↓
결재 완료 시 → ZFI_ASSET_MASTER 상태 업데이트
결재 로그 → ZFI_ASSET_LOG 기록
```

---

## \[8. 확장 고려 사항]

* 결재 첨부파일 (`ZFI_APPROVAL_FILE`)
* 승인/반려 알림 시스템 연계 (메일, 슬랙 등)
* 결재 코멘트 스레드 기능 (답글형 의견 구조)
* SAP 연동: 승인 완료 시 자산분개, 전표 자동 생성 트리거
* 승인 유형별 템플릿 구성 (폐기 vs 리폼 vs 수선)

---

```

→ 이 정의서를 기준으로 곧바로 `ZFI_APPROVAL_LINE`, `ZFI_APPROVAL_LINE_STEP` 테이블 설계를 이어서 진행할 수 있어.  
진행할까?
```
