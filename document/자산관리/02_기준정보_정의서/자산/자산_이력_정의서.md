# 문서명: 자산이력_정의서.md
- 작성일: 2025-05-23
- 작성자: 송영근
- 내  용: 자산의 이동, 수선, 대여, 리폼, 폐기 등 생애주기 전반의 행위 이력을 통합적으로 기록하고 연동 테이블 기반으로 추적 가능한 통합 이력 정의서

---

## [1. 정의]

**자산이력(Asset Log)**은 개별 자산의 상태 및 위치 변경과 관련된 모든 행위를  
시간순으로 기록하며, 이력을 통합하여 추적 가능한 형태로 관리하는 기록 기반 구조이다.  
이 이력은 **감사, 운영 분석, 통제, 자동 경고 알림, 회계 연계**의 기준이 된다.

---

## [2. 기록 대상 행위 유형]

| 유형 | 설명 |
|------|------|
| 등록 | 신규 자산 등록 시 최초 생성 로그 |
| 이동 | `ZFI_ASSET_MOVEMENT` 이동 발생 시 |
| 대여 | `ZFI_ASSET_RENT` 대여 및 반납 시 |
| 수선 | `ZFI_ASSET_REPAIR` 수선 요청/완료 시 |
| 리폼 | `ZFI_ASSET_REFORM` 리폼 처리 시 |
| 폐기 | `assetStatus = DISPOSED` 처리 시 |

---

## [3. 연계 테이블 구조]

```txt
ZFI_ASSET_LOG
 ├─ assetId        → ZFI_ASSET_MASTER.id
 ├─ refType        = MOVEMENT, REPAIR, REFORM, RENT 등
 ├─ refId          → 참조 테이블의 PK (예: ZFI_ASSET_REPAIR.id)
 ├─ actionType     = 이동, 대여, 리폼, 수선 등 코드
 ├─ description    = 상세 내용
 ├─ handlerId      → ZCM_USER.userId
 └─ changedAt      = ISO 일시
````

---

## \[4. 필드 예시]

| 필드명         | 설명                                     |
| ----------- | -------------------------------------- |
| assetId     | 대상 자산 ID                               |
| refType     | 연계 테이블 유형 (REPAIR, MOVEMENT 등)         |
| refId       | 연계 테이블의 고유 ID                          |
| actionType  | 처리 동작 코드 (RENT\_START, MOVE, REFORM 등) |
| description | 상세 설명 (예: "해외 전시를 위한 이동")              |
| handlerId   | 수행자 (ZCM\_USER.userId)                 |
| changedAt   | 처리 일시                                  |

---

## \[5. 이력 흐름 예시]

| 시점         | 행위 | 기록 예시                     |
| ---------- | -- | ------------------------- |
| 2024-06-01 | 이동 | LED 조명이 서울 본사 → 부산 지사 이동됨 |
| 2024-06-15 | 대여 | 프로젝터가 뉴욕 지사로 대여됨          |
| 2024-07-01 | 리폼 | 마이크 리폼 완료, 신규 자산 등록       |
| 2024-07-10 | 수선 | 음향 믹서 수선 완료 처리됨           |

---

## \[6. 활용 목적]

* 자산 단위 이력 조회 (UI 기반 또는 PDF 리포트)
* 감사 및 책임자 추적
* 상태 변화 근거 제공
* 이력 기반 자동 알림 (예: 대여 기간 초과, 수선 지연 등)
* KPI 분석 (대여 빈도, 수선율, 리폼 소요일 등)

---

## \[7. 관리 기준]

* 모든 로그는 변경 불가 및 삭제 금지 (감사 대상)
* 이력은 `assetId`별로 통합 정렬 가능해야 하며, `changedAt DESC` 우선순위 정렬
* 비정상 종료, 실패 상태도 반드시 기록

---

## \[8. 확장 고려 사항]

* 위치 기반(GPS, RFID) 자동 로그 연동
* 사용자 접근 로그(`ZCM_MENU_LOG`)와 연계하여 원인 추론
* 로그 보존 기간 설정 (예: 5년)

```

